if(jQuery)(function($){
	$(document).ready(function(){
		$('#mainmenu').mainNav();
		$('.boxes-list').eqRow({columnElement:'.holder, .img-holder'});
	});

	//
	var EqRow = function(elem, options){
		this.elem = elem;
		this.$elem = $(elem);
		this.options = options;
	};
	EqRow.prototype = {
		defaults: {
			columnElement:'.eq-height'
		},
		init:function(){
			var self = this;
			self.config = $.extend({}, self.defaults, this.options);
			self._eqHeight();
			$(window).on('load resize', function(){self._eqHeight()});
			return this;
		},
		_eqHeight:function(){
			var self = this, $col = $(self.config.columnElement, self.$elem), $top = 0, current_row_start = 0, current_tallest = 0, row_divs = new Array();
			$col.each(function(){
				var $i_i = $(this);
				$i_i.css({'height':'auto'});
				$top = $i_i.position().top;

				if(current_row_start != $top){
					for(current_div = 0; current_div < row_divs.length; current_div++){
						row_divs[current_div].height(current_tallest);
					}
					row_divs.length = 0; // empty the array
					current_row_start = $top;
					current_tallest = $i_i.height();
					row_divs.push($i_i);
				}else{
					row_divs.push($i_i);
					current_tallest = (current_tallest < $i_i.height()) ? ($i_i.height()) : (current_tallest);
				}
				for(current_div = 0; current_div < row_divs.length; current_div++){
					row_divs[current_div].height(current_tallest);
				}
			});
		}
	}
	EqRow.defaults = EqRow.prototype.defaults;
	$.fn.eqRow = function(options){
		return this.each(function(){
			new EqRow(this, options).init();
		});
	};

	var MainNav = function(elem){
		this.elem = elem;
		this.$elem = $(elem);
		this.$btn = $('<div class="mobile-box"><span class="btn-menu"><a href="#" title="Menu">Menu</a></span></div>');
		this.mobile = true;
	};
	MainNav.prototype = {
		init:function(){
			var self = this;
			self.config = $.extend({}, self.defaults);
			self._aIcon();
			self._hBtn();
			return this;
		},
		_dAction:function(dropdown){

		},
		_hBtn:function(){
			var self = this;
			$('#header .holder:eq(0)').prepend(self.$btn);
			self.$btn.on('click', function(e){
				var $overflow = $('#overlay-fix');
				$overflow.toggleClass('pushaway');
				e.preventDefault();
			})
		},
		_aIcon:function(){
			var self = this;
			$('a', self.$elem).each(function(){
				if($(this).siblings('ul').length > 0) $(this).addClass('arrowed');
			});
		}
	}
	MainNav.defaults = MainNav.prototype.defaults;
	$.fn.mainNav = function(){
		return this.each(function(){
			new MainNav(this).init();
		});
	};
})(jQuery);